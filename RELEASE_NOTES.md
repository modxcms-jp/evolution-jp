# Evolution JP PHP8対応版 リリース情報

## 🎯 重要：PHP8完全対応

長らくお待たせしました。**Evolution JPがPHP8に完全対応**しました。
PHP8.0、8.1、8.2、8.3環境で安定動作します。

---

## 一般ユーザー向け情報

### 🎨 管理画面が大きく進化

#### 新しいテーマが7種類追加されました
好みに応じて管理画面のデザインを選べるようになりました：

1. **AuroraFlow** - モダンで洗練されたデザイン（新デフォルト）
2. **RevoClassic** - 従来のスタイルを踏襲
3. **SoftSlate** - 柔らかく優しい印象
4. **ZenWhite** - シンプルで見やすいミニマルデザイン
5. **BlossomBlush** - 華やかなピンク系テーマ
6. **SakuraFlow** - 和風の桜テーマ
7. **MojitoGreen** - 爽やかなグリーンテーマ

#### 操作性の改善
- **チェックボックスがトグルスイッチに** - ON/OFFが一目でわかるモダンなUIに
- **ログイン画面を刷新** - パスワードの表示/非表示切り替えボタン付き
- **レスポンシブ対応強化** - タブレットでも使いやすく

### ✏️ エディタが最新版に

- **TinyMCE7を搭載** - 最新の高機能エディタで快適な編集
- **TinyMCE3を廃止** - 古いバージョンは削除されました

### 📁 ファイルブラウザが使いやすく

長年ほとんど変わっていなかったMCPUKファイルブラウザを大幅改善：

- **フォルダツリー表示** - フォルダ階層が見やすくなりました
- **デザインの統一** - 管理画面のテーマに合わせたスタイル
- **長いファイル名に対応** - 文字が途切れず表示されます
- **操作ボタンの改善** - より直感的に

### 🔧 インストール・アップグレードが簡単に

#### データベース文字コード変換機能
- **UTF-8MB4への自動変換** - 絵文字や多言語対応の文字コードに簡単移行
- アップグレード時の文字化け防止

#### インストーラの改善
- **二重送信防止** - ボタン連打による誤動作を防止
- **一括選択機能** - プラグインやモジュールを一括で選択可能
- **エラー表示の改善** - 問題が起きた時に原因がわかりやすく
- **操作性向上** - よりスムーズなインストール体験

### 🗑️ 古いブラウザ対応を廃止

- **Internet Explorer対応を完全廃止**
  - IE11を含むすべてのIEサポート終了
  - モダンブラウザ（Chrome、Firefox、Edge、Safari）での利用を推奨
  - これにより動作が軽快に、メンテナンスも容易になりました

### 🛡️ セキュリティ強化

- **CSRF（クロスサイトリクエストフォージェリ）対策を強化**
  - 管理画面のフォーム送信がより安全に
- **ファイルアップロード時のセキュリティ改善**
  - 不正なファイル名を自動的にサニタイズ
- **各種セキュリティ脆弱性の修正**

### 📊 新機能

- **イベントログのエクスポート機能** - ログをテキストファイルで保存可能
- **メール送信ログ機能（オプション）** - MODxMailerの送信履歴を記録
- **プレビュー機能の強化** - より安全なプレビュー表示

### ⚡ 安定性の向上

**数百箇所のエラーを修正し、安定性が大幅に向上しました：**

- PHP8環境でのエラー・警告を徹底的に修正
- Dittoスニペットの安定性向上
- WebLoginプラグインの改善
- リソース管理画面のエラー修正
- キャッシュ処理の最適化

### 📋 動作環境の変更

**推奨環境：**
- PHP 8.0 / 8.1 / 8.2 / 8.3
- MySQL 5.7以上 / MariaDB 10.2以上
- モダンブラウザ（Chrome、Firefox、Edge、Safari最新版）

**非対応：**
- PHP 7.x以下
- Internet Explorer（全バージョン）

---

## エンジニア向け情報

### 🚀 コードベースのモダン化

#### PHP8対応の詳細
- 動的プロパティの明示的宣言（PHP8.2対応）
- Null合体演算子(`??`)の活用による安全な配列アクセス
- 非推奨関数の置き換え（`strftime` → `mb_strftime`等）
- 型安全性の強化
- 配列構文の統一（`array()` → `[]`）

#### JavaScriptのモダン化
- ES6+対応：`var` → `let`/`const`
- クラス構文の導入（WebFXTabPane等）
- `addEventListener`への完全移行
- アロー関数の活用
- MooToolsライブラリの完全削除 → ネイティブAPI実装

#### コード品質向上
- トレイトの導入（コード再利用性向上）
- アクセス修飾子の明示化
- ヘルパー関数の統一（`getv()`, `postv()`, `anyv()`等）
- 不要コードの大規模削除
- コードスタイルの統一

### 💾 アーキテクチャ改善

#### キャッシュシステム
- `MODX_CACHE_PATH`定数による一元管理
- キャッシュリフレッシュロジックの改善
- URL→ドキュメントIDマッピングの最適化

#### データベース
- MySQL拡張を完全削除（MySQLi専用）
- 接続処理の改善（タイムアウト、エラーハンドリング）
- `event_log`テーブルのsourceカラム拡大

#### テーマシステム
- CSS変数の大規模導入（150箇所以上）
- 論理プロパティによるRTL対応
- テーマ共通化によるメンテナンス性向上

### 📚 開発ドキュメント

- `AGENTS.md` - 開発ガイドライン（日本語）
- アーキテクチャドキュメント
- Data URI自動ファイル化機能のドキュメント

### 🔧 技術的負債の解消

- レガシーコードの削除（IE対応、MooTools等）
- 数百箇所のPHP8非互換コードの修正
- セキュリティ脆弱性の修正
- エラーハンドリングの包括的改善

---

## アップグレード時の注意事項

1. **PHP8環境の準備**
   - サーバーがPHP8.0以上に対応していることを確認してください

2. **バックアップの取得**
   - データベースとファイルの完全バックアップを必ず取得してください

3. **ブラウザ要件の確認**
   - Internet Explorerは使用できなくなりました
   - モダンブラウザをご利用ください

4. **UTF-8MB4への移行（推奨）**
   - インストーラで文字コード変換機能を利用できます
   - 絵文字対応や多言語対応が向上します

---

この包括的なアップデートにより、Evolution JPは次の10年を見据えた、モダンで安全、メンテナンスしやすいCMSに生まれ変わりました。
